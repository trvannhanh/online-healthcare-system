<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Chỉnh Sửa Lịch Hẹn</title>
    <th:block th:replace="base :: styles"></th:block>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div th:replace="base :: header"></div>
    <main>
        <div class="d-flex bg-secondary">
            <div th:replace="base :: sidebar" class="p-2"></div>
            <div class="p-2 bg-light flex-grow-1">
                <h1 class="text-center text-info mt-3 mb-4">Chỉnh Sửa Lịch Hẹn</h1>
                <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
                <form th:action="@{/appointments/edit/{id}(id=${appointment.id})}" method="post">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Bệnh nhân:</label>
                            <select name="patient" class="form-control" required>
                                <option th:each="p : ${patients}" th:value="${p.id}" th:text="${p.getUser().getLastName()}" th:selected="${p.id == appointment.getPatient().getId()}"></option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Bác sĩ:</label>
                            <select name="doctor" class="form-control" required>
                                <option th:each="d : ${doctors}" th:value="${d.id}" th:text="${d.getUser().getLastName()}" th:selected="${d.id == appointment.getDoctor().getId()}"></option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Ngày hẹn:</label>
                            <input type="datetime-local" name="appointmentDate" class="form-control" th:value="${#temporals.format(appointment.getAppointmentDate(), 'yyyy-MM-dd\'T\'HH:mm')}" required/>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Trạng thái:</label>
                            <select name="status" class="form-control" required>
                                <option value="PENDING" th:selected="${appointment.getStatus() == T(com.can.pojo.AppointmentStatus).PENDING}">Đang chờ</option>
                                <option value="CONFIRMED" th:selected="${appointment.getStatus() == T(com.can.pojo.AppointmentStatus).CONFIRMED}">Đã xác nhận</option>
                                <option value="CANCELLED" th:selected="${appointment.getStatus() == T(com.can.pojo.AppointmentStatus).CANCELLED}">Đã huỷ</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary">Lưu</button>
                            <a th:href="@{/appointments}" class="btn btn-secondary">Hủy</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>
    <div th:replace="base :: footer"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>