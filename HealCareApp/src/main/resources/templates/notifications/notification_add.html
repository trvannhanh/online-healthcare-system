<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>Th√™m Th√¥ng B√°o</title>
    <th:block th:replace="base :: styles"></th:block>
  </head>
  <body>
    <div th:replace="base :: header"></div>

    <main>
      <div class="d-flex bg-secondary">
        <div th:replace="base :: sidebar" class="p-2"></div>
        <div class="p-2 bg-light flex-grow-1">
          <h1 class="text-center text-info mt-1">Th√™m Th√¥ng B√°o</h1>
          <form
            th:action="@{/notifications/add}"
            th:object="${notification}"
            method="post"
          >
            <div class="mb-3">
              <label>Lo·∫°i ng∆∞·ªùi nh·∫≠n:</label>
              <select name="role" id="userType" class="form-control">
                <option value="">-- Ch·ªçn lo·∫°i ng∆∞·ªùi nh·∫≠n --</option>
                <option value="PATIENT">B·ªánh nh√¢n</option>
              </select>
            </div>
            <div class="mb-3">
              <label>Lo·∫°i th√¥ng b√°o</label>
              <select
                th:field="*{type}"
                class="form-control"
                onchange="fillMessageTemplate(this.value)"
              >
                <option value="">-- Ch·ªçn lo·∫°i th√¥ng b√°o --</option>
                <option value="DISCOUNT">∆Øu ƒë√£i</option>
                <option value="HEALTH_PROGRAM">
                  Ch∆∞∆°ng tr√¨nh kh√°m mi·ªÖn ph√≠
                </option>
              </select>
            </div>
            <div class="mb-3">
              <label>N·ªôi dung th√¥ng b√°o:</label>
              <textarea
              id="message"
                class="form-control"
                th:field="*{message}"
                placeholder="Nh·∫≠p n·ªôi dung th√¥ng b√°o"
                required
              ></textarea>
            </div>
            <div class="mb-3">
              <label>Ng√†y g·ª≠i:</label>
              <input
                class="form-control"
                type="date"
                th:field="*{sentAt}"
                required
              />
            </div>
            <button type="submit" class="btn btn-primary">
              Th√™m Th√¥ng B√°o
            </button>
          </form>
        </div>
      </div>
    </main>
    <div th:replace="base :: footer"></div>
    <script>
      function fillMessageTemplate(type) {
        let msg = "";
        const today = new Date().toLocaleDateString("vi-VN");

        switch (type) {
          case "DISCOUNT":
            msg =
              "üéâ ∆Øu ƒë√£i ƒë·∫∑c bi·ªát l√™n ƒë·∫øn 50% cho kh√°ch h√†ng ƒë·∫∑t l·ªãch kh√°m trong tu·∫ßn n√†y!";
            break;
          case "HEALTH_PROGRAM":
            msg = `üè• Tham gia ch∆∞∆°ng tr√¨nh kh√°m s·ª©c kh·ªèe t·ªïng qu√°t mi·ªÖn ph√≠ t·ª´ ng√†y ${today}.`;
            break;
        }

        document.getElementById("message").value = msg;
      }
    </script>
  </body>
</html>
