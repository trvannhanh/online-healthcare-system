<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>Quản Lý Thông Báo</title>
    <th:block th:replace="base :: styles"></th:block>
  </head>
  <body>
    <div th:replace="base :: header"></div>

    <main>
      <div class="d-flex bg-secondary">
        <div th:replace="base :: sidebar" class="p-2"></div>
        <div class="p-2 bg-light flex-grow-1">
          <h1 class="text-center text-info mt-1">Quản Lý Thông Báo</h1>

          <!-- Form lọc thông báo -->
          <form th:action="@{/notifications}" method="get">
            <div class="mb-3">
              <label>Loại người nhận:</label>
              <select name="role" id="userType" class="form-control">
                <option value="">-- Chọn loại người nhận --</option>
                <option value="PATIENT">Bệnh nhân</option>
              </select>
            </div>
            <div class="mb-3">
              <label>Ngày gửi:</label>
              <input type="date" name="sentAt" class="form-control" />
            </div>

            <button type="submit" class="btn btn-primary">Lọc</button>
          </form>

          <!-- Nút thêm thông báo -->
          <a th:href="@{/notifications/add}" class="btn btn-success mt-1"
            >Thêm Thông Báo</a
          >

          <!-- Bảng danh sách thông báo -->
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Người Nhận</th>
                <th>Loại Người Nhận</th>
                <th>Nội Dung</th>
                <th>Ngày Gửi</th>
                <th>Hành Động</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="n : ${notifications}">
                <td th:text="${n.getUser().getFullName()}"></td>
                <td th:text="${n.getUser().getRole()}"></td>
                <td th:text="${n.getMessage()}"></td>
                <td
                  th:text="${n.getSentAt()}"
                ></td>
                <td>
                  <button
                    th:onclick="'deleteNotification(\'' + @{/api/notifications} + '\', ' + ${n.id} + ')'"
                    class="btn btn-danger"
                  >
                    &times;
                  </button>
                  <a
                    th:href="@{/notifications/edit(id=${n.id})}"
                    class="btn btn-info"
                    >Sửa</a
                  >
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <div th:replace="base :: footer"></div>
    <script th:src="@{/js/main.js}"></script>
  </body>
</html>
